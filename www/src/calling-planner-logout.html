<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="app-data.html">
<link rel="import" href="shared-styles.html">

<dom-module id="calling-planner-logout">
  <template>
    <style include="shared-styles">
            :host {
                margin: 0;
                padding: 0;
            }
        </style>

    <iron-ajax
      id="registerLogoutAjax"
      method="delete"
      content-type="application/json"
      handle-as="text"
      on-response="handleUserResponse"
      on-error="handleUserError">
    </iron-ajax>

<!--     <app-data key="userData" data="{{storedUser}}"></app-data>

    <template is="dom-if" if="{{!link}}">
        <paper-button raised on-tap="logout">Log Out</paper-button>
    </template>

    <template is="dom-if" if="{{link}}">
        <a on-tap="logout" href>Log Out</a>
    </template> -->

    <div id="authenticated">
        <h2>Hello, [[storedUser.name]]!</h2>
        <p>You are currently logged in.</p>
        <paper-button raised class="primary" on-tap="postLogout">Log out</paper-button>
    </div>

  </template>

  <script>
    Polymer({
      is: 'calling-planner-logout',
      properties: {
        storedUser: Object,
        link: {
            type: Boolean,
            value: false
        }
    },
    logout: function() {
        // remove user data
        this.$.registerLogoutAjax.url = 'http://localhost:3000/api/auth';
        this._setReqBody();
        this.$.registerLogoutAjax.generateRequest();
        this.storedUser = null;
    }

    });
  </script>
</dom-module>
